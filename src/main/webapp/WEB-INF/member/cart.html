<!DOCTYPE html>
<html lang="zxx">

<head>
<meta charset="utf-8">
<meta name="viewport"
	content="width=device-width, initial-scale=1, maximum-scale=1">

<title>Resido - Residence & Real Estate HTML Template</title>

<!-- Custom CSS -->
<link href="../Full_Resido/_html/assets/css/styles.css" rel="stylesheet">

<!-- chill-header css -->
<link href="../Full_Resido/_html/assets/css/chill-header.css"
	rel="stylesheet">

<!-- Custom Color Option -->
<link href="../Full_Resido/_html/assets/css/colors.css" rel="stylesheet">

<!-- Custom CSS - 不是模板提供的 -->
<link href="css/front-desk.css" rel="stylesheet">

</head>

<body class="blue-skin">

	<!-- ============================================================== -->
	<!-- Preloader - style you can find in spinners.css -->
	<!-- ============================================================== -->
	<div id="preloader">
		<div class="preloader">
			<span></span><span></span>
		</div>
	</div>

	<!-- ============================================================== -->
	<!-- Main wrapper - style you can find in pages.scss -->
	<!-- ============================================================== -->
	<div id="main-wrapper">

		<!-- ============================================================== -->
		<!-- Top header  -->
		<!-- ============================================================== -->
		<!-- Start Navigation -->
		<div class="header header-light head-shadow">
			<div class="container">
				<nav id="navigation" class="navigation navigation-landscape"></nav>
			</div>
		</div>

		<!-- End Navigation -->
		<div class="clearfix"></div>
		<!-- ============================================================== -->
		<!-- Top header  -->
		<!-- ============================================================== -->

		<!-- ============================ Page Title Start================================== -->
		<div id="page-title" class="page-title"></div>
		<!-- ============================ Page Title End ================================== -->

		<!-- ============================ User Dashboard ================================== -->
		<section class="bg-light">
			<div class="container-fluid">

				<div id="narrow-view" class="row"></div>

				<div class="row">
					<!-- ========================= 最大頁面的sidebar ========================= -->
					<div class="col-lg-3 col-md-12">

						<div class="simple-sidebar sm-sidebar" id="filter_search"></div>
					</div>

					<!-- ============================ Main Content ================================== -->
					<div class="col-lg-9 col-md-12">
						<!-- ======================== 頁面內容放這裡 ======================== -->
						<div class="dashboard-wraper">

							<!-- Location -->
							<div class="col-12">

								<!-- Single Block Wrap -->
								<div class="block-wrap">

									<div class="block-header">
										<h4 class="block-title">購物車內容</h4>
									</div>

									<div class="block-body">
										<div class="text-start py-3 px-4">
											<button class="btn btn-secondary rounded px-5" type="button">清空購物車</button>
										</div>
										<div class="p-3">
											<div class="table-responsive">
												<table
													class="table table-striped table-bordered text-center">
													<thead class="table-dark">
														<tr>
															<th class="py-3">圖片</th>
															<th class="py-3">名稱</th>
															<th class="py-3">數量</th>
															<th class="py-3">單價</th>
															<th class="py-3">操作</th>
														</tr>
													</thead>
													<tbody>
														<tr>
															<td>
																<div></div>
															</td>
															<td id="activity_name" class="fw-bold text-truncate"
																style="max-width: 60px;">古典音樂1</td>
															<td style="max-width: 120px;">
																<div
																	class="quantity-control d-flex justify-content-center align-items-center">
																	<button class="btn btn-outline-secondary btn-sm">
																		-</button>
																	<label></label> <input type="number" id="count_number"
																		class="form-control text-center mx-2" value="1"
																		min="1" max="10" />
																	<button class="btn btn-outline-secondary btn-sm">
																		+</button>
																</div>
															</td>
															<td id="unit_price">NT$ 3000</td>
															<td>
																<button class="btn btn-sm">
																	<i class="fa-solid fa-trash fs-sm"></i>
																</button>
															</td>
														</tr>
													</tbody>
												</table>
											</div>

											<div class="bg-light text-end py-3 px-4">
												<h4>
													<p class="text-success">總計: NT$</p>
												</h4>
												<h4 class="text-success" id="total_price">3000</h4>
											</div>
										</div>
										<div class="d-flex justify-content-between p-3">
											<button class="btn btn-primary rounded px-4" type="button">
												<i class="fa fa-arrow-circle-left pr-2" aria-hidden="true">
													繼續選購</i>
											</button>
											<button class="btn btn-primary rounded px-4" type="button">
												<i class="fa fa-arrow-circle-right pr-2" id="btn_gobuy"
													aria-hidden="true"> 前往結帳</i>
											</button>
										</div>
									</div>

								</div>

							</div>

						</div>
					</div>
				</div>
			</div>
		</section>
		<!-- ============================ Main Content End ================================== -->

		<!-- ============================ Call To Action ================================== -->
		<section id="cta" class="bg-primary call-to-act-wrap"></section>
		<!-- ============================ Call To Action End ================================== -->

		<!-- ============================ Footer Start ================================== -->
		<footer id="footer" class="dark-footer skin-dark-footer"></footer>
		<!-- ============================ Footer End ================================== -->

		<!-- Log In Modal -->
		<div class="modal fade" id="login" tabindex="-1" role="dialog"
			aria-labelledby="registermodal" aria-hidden="true"></div>
		<!-- End Modal -->

		<!-- ============================ 目前還找不到這個按鍵 ============================ -->
		<a id="back2Top" class="top-scroll" title="Back to top" href="#"><i
			class="ti-arrow-up"></i></a>

	</div>
	<!-- ============================================================== -->
	<!-- End Wrapper -->
	<!-- ============================================================== -->
	<section id="aaa"></section>

	<!-- ============================================================== -->
	<!-- All Jquery -->
	<!-- ============================================================== -->
	<script src="../Full_Resido/_html/assets/js/jquery.min.js"></script>
	<script src="../Full_Resido/_html/assets/js/popper.min.js"></script>
	<script src="../Full_Resido/_html/assets/js/bootstrap.min.js"></script>
	<script src="../Full_Resido/_html/assets/js/rangeslider.js"></script>
	<script src="../Full_Resido/_html/assets/js/select2.min.js"></script>
	<script
		src="../Full_Resido/_html/assets/js/jquery.magnific-popup.min.js"></script>
	<script src="../Full_Resido/_html/assets/js/slick.js"></script>
	<script src="../Full_Resido/_html/assets/js/slider-bg.js"></script>
	<script src="../Full_Resido/_html/assets/js/lightbox.js"></script>
	<script src="../Full_Resido/_html/assets/js/imagesloaded.js"></script>

	<script>
		// navbar load
		$("#navigation").load("fixed-member-navbar.html");
		$("#page-title").load("fixed-member-page-title.html");
		$("#narrow-view").load("fixed-member-narrow-view.html");
		$("#filter_search").load("fixed-member-sidebar.html");
		$("#cta").load("fixed-member-cta.html");
		$("#footer").load("fixed-member-footer.html");
		$("#login").load("fixed-member-login.html");
	</script>

	<script src="../Full_Resido/_html/assets/js/custom.js"></script>
	<!-- ============================================================== -->
	<!-- This page plugins -->
	<!-- ============================================================== -->

	<script>
		function openFilterSearch() {
			document.getElementById("filter_search").style.display = "block";
		}
		function closeFilterSearch() {
			document.getElementById("filter_search").style.display = "none";
		}
	</script>

	<script>
		$(document).ready(function() {
			$("#showbutton").click(function() {
				$("#showing").slideToggle("slow");
			});
		});
	</script>

	<!-- ============================地址選單的js============================== -->
	<script src="../member/js/address_form.js"></script>

	<!-- <script src="../_html/assets/js/dropzone.js"></script> -->
	<!-- New Js -->
	<script>
		findAllProducts();
		
		function findAllProducts() {
			fetch('/chill-tribe/cart')
				.then(response => response.json())
				.then(data => {
					console.log("從 後端 獲取的數據:", data);
					data.forEach((product, i) => {
						document.getElementById("activity_name").innerHTML = product.activity.activityName || "暫無"
					}
				)
			});
		};
	</script>
	
	<!-- 購物車開始 -->
	<script>
    let data = {
        activity_name: document.getElementById('activity_name').innerText,
        count_number: parseInt(document.getElementById('count_number').value), 
        total_price: parseInt(document.getElementById('total_price').innerText) 
    }

    console.log(data);

    $('#btn_gobuy').on("click", function(){
        console.log("結帳按鈕被觸發");

        console.log("document.URL : "+document.URL);
        console.log("document.location.href : "+document.location.href);
        console.log("document.location.origin : "+document.location.origin);
        console.log("document.location.hostname : "+document.location.hostname);
        console.log("document.location.host : "+document.location.host);
        console.log("document.location.pathname : "+document.location.pathname);
        console.log("domain : "+document.domain);
        
        fetch("/chill-tribe/order/buy", { 
            method: 'POST',
            body: JSON.stringify(data),
            headers: {
                'Content-Type': 'application/json' 
            }
        })
        .then(response => response.json())
        .then(result => {
            $("#aaa").html(result.successful ? "結帳成功" : result.errMsg);
        })
        .catch(error => console.error('Error:', error));
    });
	</script>
	<!-- 購物車結束 -->
</body>

</html>