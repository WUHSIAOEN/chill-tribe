<!DOCTYPE html>
<html lang="zxx">

<head>
<meta charset="utf-8">
<meta name="viewport"
	content="width=device-width, initial-scale=1, maximum-scale=1">

<title>一般會員個人檔案</title>

<!-- Custom CSS -->
<link href="../Full_Resido/_html/assets/css/styles.css" rel="stylesheet">

<!-- chill-header css -->
<link href="../Full_Resido/_html/assets/css/chill-header.css"
	rel="stylesheet">


<!-- Custom Color Option -->
<link href="../Full_Resido/_html/assets/css/colors.css" rel="stylesheet">

<!-- Custom CSS - 不是模板提供的 -->
<link href="css/front-desk.css" rel="stylesheet">

</head>

<body class="blue-skin">

	<!-- ============================================================== -->
	<!-- Preloader - style you can find in spinners.css -->
	<!-- ============================================================== -->
	<div id="preloader">
		<div class="preloader">
			<span></span><span></span>
		</div>
	</div>

	<!-- ============================================================== -->
	<!-- Main wrapper - style you can find in pages.scss -->
	<!-- ============================================================== -->
	<div id="main-wrapper">

		<!-- ============================================================== -->
		<!-- Top header  -->
		<!-- ============================================================== -->
		<!-- Start Navigation -->
		<div class="header header-light head-shadow">
			<div class="container">
				<nav id="navigation" class="navigation navigation-landscape"></nav>
			</div>
		</div>

		<!-- End Navigation -->
		<div class="clearfix"></div>
		<!-- ============================================================== -->
		<!-- Top header  -->
		<!-- ============================================================== -->

		<!-- ============================ Page Title Start================================== -->
		<div id="page-title" class="page-title"></div>
		<!-- ============================ Page Title End ================================== -->

		<!-- ============================ User Dashboard ================================== -->
		<section class="bg-light">
			<div class="container-fluid">

				<div id="narrow-view" class="row"></div>

				<div class="row">
					<!-- ========================= 最大頁面的sidebar ========================= -->
					<div class="col-lg-3 col-md-12">

						<div class="simple-sidebar sm-sidebar" id="filter_search"></div>
					</div>

					<!-- ============================ Main Content ================================== -->
					<div class="col-lg-9 col-md-12">
						<!-- ======================== 頁面內容放這裡 ======================== -->
						<div class="dashboard-wraper">
							<div class="form-submit">
								<h4>個人檔案</h4>
								<div class="submit-section">
									<div class="row">
										<div class="form-group col-md-6">
											<label>顯示名稱</label> <span class="input-required">*</span> <input
												type="text" class="form-control" id="member_name" value="">
										</div>

										<div class="form-group col-md-6">
											<label>帳號/Email</label> <input type="email"
												class="form-control simple" id="email" value="" disabled>
										</div>

										<div class="form-group col-md-6">
											<label>生日</label> <input type="date" name="member-birthday"
												class="form-control" id="date_of_birth" value="">
										</div>

										<!-- 										<div class="form-group col-md-6"> -->
										<!-- 											<label>身分證字號</label> -->
										<!-- 											<span class="input-required">*</span> -->
										<!-- 											<input type="text" class="form-control simple" id="id_card" -->
										<!-- 												value="" disabled> -->
										<!-- 										</div> -->

										<div class="form-group col-md-6">
											<label>性別</label> <select name="gender" id="gender"
												class="form-control">
												<option value="1">男生</option>
												<option value="2">女生</option>
												<option value="3">請選擇</option>
											</select>
										</div>

										<div class="form-group col-md-6">
											<label>手機號碼</label> <span class="input-required">*</span> <input
												type="text" class="form-control" id="phone">
										</div>
									</div>
								</div>
							</div>

							<div class="form-submit">
								<div class="submit-section">
									<div class="row">

										<div class="form-group col-lg-12 col-md-12"
											style="display: flex; justify-content: flex-end;">
											<button class="btn btn-primary rounded px-3" type="button"
												id="editBtn">儲存變更</button>
										</div>

									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</section>
		<!-- ============================ Main Content End ================================== -->

		<!-- ============================ Call To Action ================================== -->
		<section id="cta" class="bg-primary call-to-act-wrap"></section>
		<!-- ============================ Call To Action End ================================== -->

		<!-- ============================ Footer Start ================================== -->
		<footer id="footer" class="dark-footer skin-dark-footer"></footer>
		<!-- ============================ Footer End ================================== -->

		<!-- Log In Modal -->
		<div class="modal fade" id="login" tabindex="-1" role="dialog"
			aria-labelledby="registermodal" aria-hidden="true"></div>
		<!-- End Modal -->

		<!-- ============================ 目前還找不到這個按鍵 ============================ -->
		<a id="back2Top" class="top-scroll" title="Back to top" href="#"><i
			class="ti-arrow-up"></i></a>

	</div>

	<input type="hidden" id="details_member_id" value="">
	<input type="hidden" id="member_id" value="">
	<!-- ============================================================== -->
	<!-- End Wrapper -->
	<!-- ============================================================== -->


	<!-- ============================================================== -->
	<!-- All Jquery -->
	<!-- ============================================================== -->
	<script src="../Full_Resido/_html/assets/js/jquery.min.js"></script>
	<script src="../Full_Resido/_html/assets/js/popper.min.js"></script>
	<script src="../Full_Resido/_html/assets/js/bootstrap.min.js"></script>
	<script src="../Full_Resido/_html/assets/js/rangeslider.js"></script>
	<script src="../Full_Resido/_html/assets/js/select2.min.js"></script>
	<script
		src="../Full_Resido/_html/assets/js/jquery.magnific-popup.min.js"></script>
	<script src="../Full_Resido/_html/assets/js/slick.js"></script>
	<script src="../Full_Resido/_html/assets/js/slider-bg.js"></script>
	<script src="../Full_Resido/_html/assets/js/lightbox.js"></script>
	<script src="../Full_Resido/_html/assets/js/imagesloaded.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

	<script>
		// navbar load
		$("#navigation").load("fixed-member-navbar.html");
		$("#page-title").load("fixed-member-page-title.html");
		$("#narrow-view").load("fixed-member-narrow-view.html");
		$("#filter_search").load("fixed-member-sidebar.html");
		$("#cta").load("fixed-member-cta.html");
		$("#footer").load("fixed-member-footer.html");
		$("#login").load("fixed-member-login.html");
	</script>

	<script src="../Full_Resido/_html/assets/js/custom.js"></script>
	<!-- ============================================================== -->
	<!-- This page plugins -->
	<!-- ============================================================== -->

	<script>
		function openFilterSearch() {
			document.getElementById("filter_search").style.display = "block";
		}
		function closeFilterSearch() {
			document.getElementById("filter_search").style.display = "none";
		}
	</script>

	<script>
		$(document).ready(function() {
			$("#showbutton").click(function() {
				$("#showing").slideToggle("slow");
			});
		});
	</script>

	<script>
	
	const membername = document.querySelector('#member_name');
	const password = document.querySelector('#password');
	const cPassword = document.querySelector('#cPassword');
	const phone = document.querySelector('#phone');
	const email = document.querySelector('#email');
	const dateofbirth = document.querySelector('#date_of_birth');
	const gender = document.querySelector('#gender');
	const msg = document.querySelector('#msg');
	const details_member_id = document.querySelector('#details_member_id');
	const member_id = document.querySelector('#member_id');
	const memberid = sessionStorage.getItem('memberid');

// 	debugger;
	fetch(`find/${memberid}`)
		.then(resp => resp.json())
		.then(member => {
			console.log(member);
// 			member_id.value = member.memberid;
			membername.value = member.membername;
			email.value = member.email;
			phone.value = member.phone;
			dateofbirth.value = member.strdateofbirth;
			gender.value = member.gender;
			details_member_id.value = member.memberid;
// 			photobase64.value = member.photobase64;
			
		});

// 	document.querySelector('#logoutBtn').addEventListener('click', () => {
// 		if (confirm('是否登出?')) {
// 			fetch('logout')
// 				.then(resp => resp.json())
// 				.then(body => {
// 					if (body.successful) {
// 						location.href = 'login.html';
// 					}
// 				});
// 		}
// 	});

	document.querySelector('#editBtn').addEventListener('click', () => {
		console.log("觸發儲存變更按鈕囉！");
// 		let len = password.value.length
// 		if (len !== 0 && (len < 6 || len >12)) {
// 			alert('密碼長度須介於6 ~ 12');
// 			return;
// 		}
		
// 		if (len !== 0 && password.value !== cPassword.value) {
// 			alert('密碼與確認密碼不同');
// 			return;
// 		}
		
// 		debugger;
		fetch('memberedit', {
			method: 'PUT',
			headers: {
				'Content-Type': 'application/json'
			},
			body: JSON.stringify({
				membername: membername.value,
				phone: phone.value,
				dateofbirth: dateofbirth.value,
				gender: gender.value,
				memberid: member_id.value
			}),
		})
		
		// console.log(resp)
		 .then(resp => {
			 return resp.json();
		 })
		 .then(body => {
			 const { successful, errMsg } = body;
			 if (body.successful) {
				console.log("恭喜，個資修改成功囉！！！");
// 				alert('個資修改成功囉！');
				Swal.fire({
					  icon: "success",
					  title: "恭喜",
					  text: "個資修改成功囉！",
					});
			 }else {
				 console.log("OH~NO...您個資修改失敗了！！！");
// 				 alert('OH~不，個資修改失敗...');
				 Swal.fire({
					  icon: "error",
					  title: "Oh...糟糕",
					  text: "個資修改失敗...",
					});
			 }
		 });
	});
</script>

</body>

</html>